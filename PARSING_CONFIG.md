# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞

## –ì–¥–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä—ã

–í—Å–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ **`parsers/selectors.py`**

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è:
- Avito (–†–æ—Å—Å–∏—è)
- Kufar (–ë–µ–ª–∞—Ä—É—Å—å)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤

### Avito —Å–µ–ª–µ–∫—Ç–æ—Ä—ã (`AVITO_SELECTORS`)

```python
AVITO_SELECTORS = {
    'item_container': [...],  # –ö–∞–∫ –Ω–∞–π—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏
    'item_id': [...],         # –ö–∞–∫ –∏–∑–≤–ª–µ—á—å ID –æ–±—ä—è–≤–ª–µ–Ω–∏—è
    'item_link': [...],       # –ö–∞–∫ –Ω–∞–π—Ç–∏ —Å—Å—ã–ª–∫—É –Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
    'item_title': [...],      # –ö–∞–∫ –Ω–∞–π—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫
    'item_price': [...],      # –ö–∞–∫ –Ω–∞–π—Ç–∏ —Ü–µ–Ω—É
    'item_description': [...], # –ö–∞–∫ –Ω–∞–π—Ç–∏ –æ–ø–∏—Å–∞–Ω–∏–µ
}
```

### Kufar —Å–µ–ª–µ–∫—Ç–æ—Ä—ã (`KUFAR_SELECTORS`)

```python
KUFAR_SELECTORS = {
    'item_container': [...],  # –ö–∞–∫ –Ω–∞–π—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏
    'item_id': [...],         # –ö–∞–∫ –∏–∑–≤–ª–µ—á—å ID –æ–±—ä—è–≤–ª–µ–Ω–∏—è
    'item_link': [...],       # –ö–∞–∫ –Ω–∞–π—Ç–∏ —Å—Å—ã–ª–∫—É –Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
    'item_title': [...],      # –ö–∞–∫ –Ω–∞–π—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫
    'item_price': [...],      # –ö–∞–∫ –Ω–∞–π—Ç–∏ —Ü–µ–Ω—É
    'item_region': [...],     # –ö–∞–∫ –Ω–∞–π—Ç–∏ —Ä–µ–≥–∏–æ–Ω/–≥–æ—Ä–æ–¥
}
```

## –ö–∞–∫ –Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ

- **Avito:** https://www.avito.ru/moskva/telefony?q=iphone
- **Kufar:** https://www.kufar.by/l/r~minsk/mobilnye-telefony/mt~apple

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)

### 3. –ù–∞–π–¥–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è

- –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –≤—ã–±–æ—Ä–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ (Ctrl+Shift+C)
- –ù–∞–≤–µ–¥–∏—Ç–µ –Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É HTML

### 4. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Avito:**
```html
<div data-marker="item">
  <a data-marker="item-title" href="/moskva/telefony/iphone_15_pro_123456">
    <h3 data-marker="item-title">iPhone 15 Pro 256GB</h3>
  </a>
  <span data-marker="item-price">85000 ‚ÇΩ</span>
</div>
```

–°–µ–ª–µ–∫—Ç–æ—Ä—ã:
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä: `div[data-marker="item"]`
- –°—Å—ã–ª–∫–∞: `a[data-marker="item-title"]`
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: `h3[data-marker="item-title"]`
- –¶–µ–Ω–∞: `span[data-marker="item-price"]`

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Kufar:**
```html
<section>
  <a class="styles_wrapper__5FoK7" href="/item/123456">
    <h3>iPhone 15 Pro 256GB</h3>
  </a>
  <p class="styles_price__aVxZc">
    <span>2500 —Ä—É–±.</span>
  </p>
  <p class="styles_region__qCRbf">–ú–∏–Ω—Å–∫, –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π</p>
</section>
```

–°–µ–ª–µ–∫—Ç–æ—Ä—ã:
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä: `section`
- –°—Å—ã–ª–∫–∞: `a.styles_wrapper__5FoK7`
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: `h3`
- –¶–µ–Ω–∞: `p.styles_price__aVxZc span`
- –†–µ–≥–∏–æ–Ω: `p.styles_region__qCRbf`

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –≤ –∫–æ–¥–µ

### –§–æ—Ä–º–∞—Ç —Å–µ–ª–µ–∫—Ç–æ—Ä–∞:

```python
{
    'tag': 'div',                    # HTML —Ç–µ–≥
    'attrs': {'data-marker': 'item'}, # –ê—Ç—Ä–∏–±—É—Ç—ã
    'class': 'some-class',          # –ö–ª–∞—Å—Å (—Å—Ç—Ä–æ–∫–∞)
    'class': re.compile(r'pattern'), # –ö–ª–∞—Å—Å (—Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ)
    'href': re.compile(r'pattern'),  # –ê—Ç—Ä–∏–±—É—Ç href
}
```

### –ü—Ä–∏–º–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

–ï—Å–ª–∏ Avito –∏–∑–º–µ–Ω–∏–ª —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `article` –≤–º–µ—Å—Ç–æ `div`:

```python
AVITO_SELECTORS['item_container'] = [
    {'tag': 'article', 'attrs': {'data-marker': 'item'}},  # –ù–æ–≤—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä
    {'tag': 'div', 'attrs': {'data-marker': 'item'}},      # –°—Ç–∞—Ä—ã–π (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)
    # ...
]
```

## –û—Ç–ª–∞–¥–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞

### 1. –í–∫–ª—é—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í —Ñ–∞–π–ª–µ `utils/logger.py` –∏–∑–º–µ–Ω–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å:
```python
logger.setLevel(logging.DEBUG)  # –í–º–µ—Å—Ç–æ INFO
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

```bash
# Docker
docker-compose logs -f app | grep -i "parser\|–Ω–∞–π–¥–µ–Ω–æ\|–æ—à–∏–±–∫–∞"

# –õ–æ–∫–∞–ª—å–Ω–æ
tail -f logs/avito_parser.log
tail -f logs/kufar_parser.log
```

### 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ HTML –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

–ü–∞—Ä—Å–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –ø–µ—Ä–≤—ã–µ 2000 —Å–∏–º–≤–æ–ª–æ–≤ HTML –≤ –ª–æ–≥–∞—Ö –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö.

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤—Ä—É—á–Ω—É—é

```python
# –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
from parsers.avito_parser import AvitoParser
from parsers.selectors import AVITO_SELECTORS

parser = AvitoParser()
response = parser._get_page("https://www.avito.ru/moskva/telefony?q=iphone")
soup = BeautifulSoup(response.text, 'lxml')

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
for selector in AVITO_SELECTORS['item_container']:
    # ...
```

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ –Ω–∞–π–¥–µ–Ω–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤ `parsers/selectors.py`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - —Ç–∞–º –±—É–¥–µ—Ç HTML –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
4. –û–±–Ω–æ–≤–∏—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å–∞–π—Ç–∞

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–≤–ª–µ—á—å —Ü–µ–Ω—É"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã —Ü–µ–Ω—ã –≤ `parsers/selectors.py`
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö, –∫–∞–∫–æ–π —Ç–µ–∫—Å—Ç –±—ã–ª –∏–∑–≤–ª–µ—á–µ–Ω
3. –û–±–Ω–æ–≤–∏—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ü–µ–Ω—ã

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–æ–¥–µ–ª—å"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –º–æ–¥–µ–ª–µ–π –≤ –ø–∞—Ä—Å–µ—Ä–∞—Ö
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –≤ `config.py` (IPHONE_MODELS)
3. –û–±–Ω–æ–≤–∏—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤ –º–µ—Ç–æ–¥–∞—Ö `_extract_iphone_model`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
PARSER_Avito/
‚îú‚îÄ‚îÄ parsers/                    # –ü–∞—Ä—Å–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ selectors.py           # ‚öôÔ∏è –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –°–ï–õ–ï–ö–¢–û–†–û–í (–ó–î–ï–°–¨ –ù–ê–°–¢–†–ê–ò–í–ê–¢–¨!)
‚îÇ   ‚îú‚îÄ‚îÄ avito_parser.py        # –ü–∞—Ä—Å–µ—Ä Avito
‚îÇ   ‚îî‚îÄ‚îÄ kufar_parser.py        # –ü–∞—Ä—Å–µ—Ä Kufar
‚îú‚îÄ‚îÄ services/                  # –°–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îî‚îÄ‚îÄ parser_service.py      # –°–µ—Ä–≤–∏—Å –ø–∞—Ä—Å–∏–Ω–≥–∞
‚îú‚îÄ‚îÄ utils/                     # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ logger.py             # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îî‚îÄ‚îÄ config.py                  # –û–±—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```

## –í–∞–∂–Ω–æ!

- **–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã** –µ—Å–ª–∏ —Å–∞–π—Ç—ã –∏–∑–º–µ–Ω–∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Å—Ç–∞—Ä—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã** –∫–∞–∫ –∑–∞–ø–∞—Å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–≥–∏** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

