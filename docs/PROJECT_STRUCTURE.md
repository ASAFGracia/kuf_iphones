# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

## –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
PARSER_Avito/
‚îú‚îÄ‚îÄ main.py                      # üöÄ –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ config.py                    # ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Ç–æ–∫–µ–Ω—ã, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
‚îú‚îÄ‚îÄ database.py                  # üíæ –†–∞–±–æ—Ç–∞ —Å PostgreSQL
‚îÇ
‚îú‚îÄ‚îÄ parsers/                     # üì° –ü–ê–†–°–ï–†–´ (Avito –∏ Kufar)
‚îÇ   ‚îú‚îÄ‚îÄ selectors.py            # ‚öôÔ∏è –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –°–ï–õ–ï–ö–¢–û–†–û–í (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∑–¥–µ—Å—å!)
‚îÇ   ‚îú‚îÄ‚îÄ avito_parser.py         # –ü–∞—Ä—Å–µ—Ä Avito (–†–æ—Å—Å–∏—è)
‚îÇ   ‚îî‚îÄ‚îÄ kufar_parser.py         # –ü–∞—Ä—Å–µ—Ä Kufar (–ë–µ–ª–∞—Ä—É—Å—å)
‚îÇ
‚îú‚îÄ‚îÄ services/                    # üîß –°–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ parser_service.py       # –°–µ—Ä–≤–∏—Å –ø–∞—Ä—Å–∏–Ω–≥–∞ (–æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –æ–±–∞ –ø–∞—Ä—Å–µ—Ä–∞)
‚îÇ   ‚îî‚îÄ‚îÄ scheduler.py            # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á (–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç –º–µ–¥–∏–∞–Ω—ã)
‚îÇ
‚îú‚îÄ‚îÄ utils/                       # üõ†Ô∏è –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ logger.py               # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ median_calculator.py    # –†–∞—Å—á–µ—Ç –º–µ–¥–∏–∞–Ω–Ω–æ–π —Ü–µ–Ω—ã
‚îÇ
‚îú‚îÄ‚îÄ bot_avito.py                 # ü§ñ Telegram –±–æ—Ç –¥–ª—è Avito
‚îú‚îÄ‚îÄ bot_kufar.py                 # ü§ñ Telegram –±–æ—Ç –¥–ª—è Kufar
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml           # üê≥ Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile                   # üê≥ Docker –æ–±—Ä–∞–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt             # üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îÇ
‚îú‚îÄ‚îÄ logs/                        # üìù –õ–æ–≥–∏ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îÇ   ‚îú‚îÄ‚îÄ main.log
‚îÇ   ‚îú‚îÄ‚îÄ avito_parser.log
‚îÇ   ‚îú‚îÄ‚îÄ kufar_parser.log
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îî‚îÄ‚îÄ README.md                    # üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

### –ì–ª–∞–≤–Ω—ã–µ —Ñ–∞–π–ª—ã

- **`main.py`** - –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã (–±–æ—Ç—ã, –ø–∞—Ä—Å–µ—Ä—ã, –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫)
- **`config.py`** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: —Ç–æ–∫–µ–Ω—ã –±–æ—Ç–æ–≤, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î, –≥–æ—Ä–æ–¥–∞, –º–æ–¥–µ–ª–∏ iPhone

### –ü–∞—Ä—Å–µ—Ä—ã (`parsers/`)

- **`selectors.py`** ‚öôÔ∏è - **–í–ê–ñ–ù–û!** –ó–¥–µ—Å—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞. –ï—Å–ª–∏ –ø–∞—Ä—Å–µ—Ä –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è - –æ–±–Ω–æ–≤–∏—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∑–¥–µ—Å—å.
- **`avito_parser.py`** - –ü–∞—Ä—Å–µ—Ä –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Å Avito (–†–æ—Å—Å–∏—è). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏–∑ `selectors.py`
- **`kufar_parser.py`** - –ü–∞—Ä—Å–µ—Ä –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Å Kufar (–ë–µ–ª–∞—Ä—É—Å—å). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏–∑ `selectors.py`

### –°–µ—Ä–≤–∏—Å—ã (`services/`)

- **`parser_service.py`** - –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –æ–±–∞ –ø–∞—Ä—Å–µ—Ä–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **`scheduler.py`** - –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á. –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 3:00 –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –º–µ–¥–∏–∞–Ω–Ω—ã–µ —Ü–µ–Ω—ã

### –£—Ç–∏–ª–∏—Ç—ã (`utils/`)

- **`logger.py`** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å —Ä–æ—Ç–∞—Ü–∏–µ–π —Ñ–∞–π–ª–æ–≤
- **`median_calculator.py`** - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç –º–µ–¥–∏–∞–Ω–Ω–æ–π —Ü–µ–Ω—ã (1000 –∑–∞–ø–∏—Å–µ–π –∑–∞ 30 –¥–Ω–µ–π)

### –ë–æ—Ç—ã

- **`bot_avito.py`** - Telegram –±–æ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Avito. –ö–æ–º–∞–Ω–¥—ã: /start, /city, /model, /price –∏ —Ç.–¥.
- **`bot_kufar.py`** - Telegram –±–æ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Kufar. –¢–µ –∂–µ –∫–æ–º–∞–Ω–¥—ã, –Ω–æ –¥–ª—è –±–µ–ª–æ—Ä—É—Å—Å–∫–æ–≥–æ —Ä—ã–Ω–∫–∞

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- **`database.py`** - –†–∞–±–æ—Ç–∞ —Å PostgreSQL. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ–±—ä—è–≤–ª–µ–Ω–∏–π, —Ä–∞—Å—á–µ—Ç –º–µ–¥–∏–∞–Ω

## –ì–¥–µ —á—Ç–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å

### üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ (–µ—Å–ª–∏ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è)

**–§–∞–π–ª:** `parsers/selectors.py`

–ó–¥–µ—Å—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö Avito –∏ Kufar.

**–°–º. –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:** `PARSING_CONFIG.md`

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–æ—Ä–æ–¥–æ–≤ –∏ –º–æ–¥–µ–ª–µ–π

**–§–∞–π–ª:** `config.py`

- `CITIES` - –≥–æ—Ä–æ–¥–∞ –¥–ª—è Avito (–†–æ—Å—Å–∏—è)
- `KUFAR_CITIES` - –≥–æ—Ä–æ–¥–∞ –¥–ª—è Kufar (–ë–µ–ª–∞—Ä—É—Å—å)
- `IPHONE_MODELS` - —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π iPhone

### üîë –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ –∏ –ë–î

**–§–∞–π–ª:** `.env`

```env
TELEGRAM_AVITO_BOT_TOKEN=...
TELEGRAM_KUFAR_BOT_TOKEN=...
DB_HOST=postgres
DB_PORT=5432
DB_NAME=parser_db
DB_USER=parser_user
DB_PASSWORD=your_secure_password_here
```

### üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞

**–§–∞–π–ª:** `.env`

```env
PARSING_INTERVAL_MINUTES=3  # –ö–∞–∂–¥—ã–µ 3 –º–∏–Ω—É—Ç—ã
```

## –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
1. main.py –∑–∞–ø—É—Å–∫–∞–µ—Ç:
   ‚îú‚îÄ‚îÄ bot_avito.py (Telegram –±–æ—Ç)
   ‚îú‚îÄ‚îÄ bot_kufar.py (Telegram –±–æ—Ç)
   ‚îú‚îÄ‚îÄ parser_service.py (—Å–µ—Ä–≤–∏—Å –ø–∞—Ä—Å–∏–Ω–≥–∞)
   ‚îî‚îÄ‚îÄ scheduler.py (–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫)

2. parser_service.py –∫–∞–∂–¥—ã–µ 3 –º–∏–Ω—É—Ç—ã:
   ‚îú‚îÄ‚îÄ –í—ã–∑—ã–≤–∞–µ—Ç avito_parser.py
   ‚îÇ   ‚îî‚îÄ‚îÄ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏–∑ parsers/selectors.py
   ‚îî‚îÄ‚îÄ –í—ã–∑—ã–≤–∞–µ—Ç kufar_parser.py
       ‚îî‚îÄ‚îÄ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏–∑ parsers/selectors.py

3. –ù–∞–π–¥–µ–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è:
   ‚îú‚îÄ‚îÄ –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ database.py
   ‚îú‚îÄ‚îÄ –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –º–µ–¥–∏–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞ (median_calculator.py)
   ‚îî‚îÄ‚îÄ –ï—Å–ª–∏ –≤—ã–≥–æ–¥–Ω–æ - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞

4. scheduler.py –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00:
   ‚îî‚îÄ‚îÄ –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –º–µ–¥–∏–∞–Ω–Ω—ã–µ —Ü–µ–Ω—ã
```

## –õ–æ–≥–∏

–í—Å–µ –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `logs/`:

- `main.log` - –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `avito_parser.log` - –ª–æ–≥–∏ –ø–∞—Ä—Å–µ—Ä–∞ Avito
- `kufar_parser.log` - –ª–æ–≥–∏ –ø–∞—Ä—Å–µ—Ä–∞ Kufar
- `avito_bot.log` - –ª–æ–≥–∏ –±–æ—Ç–∞ Avito
- `kufar_bot.log` - –ª–æ–≥–∏ –±–æ—Ç–∞ Kufar
- `database.log` - –ª–æ–≥–∏ —Ä–∞–±–æ—Ç—ã —Å –ë–î
- `parser_service.log` - –ª–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞
- `scheduler.log` - –ª–æ–≥–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
- `median_calculator.log` - –ª–æ–≥–∏ —Ä–∞—Å—á–µ—Ç–∞ –º–µ–¥–∏–∞–Ω—ã

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–µ —É–¥–∞–ª—è–π—Ç–µ –ø–∞–ø–∫—É `kuf_iphones/`** - –æ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–º –ø—Ä–æ–µ–∫—Ç–µ
2. **–í—Å–µ –ø–∞—Ä—Å–µ—Ä—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `parsers/`** - –Ω–µ –∏—â–∏—Ç–µ –∏—Ö –≤ –∫–æ—Ä–Ω–µ
3. **–°–µ–ª–µ–∫—Ç–æ—Ä—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ `parsers/selectors.py`** - –µ—Å–ª–∏ –ø–∞—Ä—Å–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–º
4. **–õ–æ–≥–∏ –ø–æ–º–æ–≥–∞—é—Ç –æ—Ç–ª–∞–¥–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã** - –≤—Å–µ–≥–¥–∞ —Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

## –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π:

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä—Å–µ—Ä –≤ `parsers/` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `onliner_parser.py`)
2. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤ `parsers/selectors.py` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ONLINER_SELECTORS`)
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `bot_onliner.py`)
4. –î–æ–±–∞–≤—å—Ç–µ –≤ `services/parser_service.py` –º–µ—Ç–æ–¥ `parse_for_user_onliner()`
5. –û–±–Ω–æ–≤–∏—Ç–µ `main.py` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞

